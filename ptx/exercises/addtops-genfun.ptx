<?xml version="1.0" encoding="UTF-8"?>
<exercises permid="exers_addtops-genfun" xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="exercises_addtops-genfun">

  <exercise permid="exers_addtops-genfun-e_xo">
    <statement>
      <p permid="exers_addtops-genfun-e_xo-p1">
        Find the generating function for each of the following sequences by relating them back to a sequence with known generating function.

        <ol permid="exers_addtops-genfun-e_xo-ol1">
          <li permid="exers_addtops-genfun-e_xo-ol1-l_j"><m>4,4,4,4,4,\ldots</m>.</li>

          <li permid="exers_addtops-genfun-e_xo-ol1-l_s"><m>2, 4, 6, 8, 10, \ldots</m>.</li>

          <li permid="exers_addtops-genfun-e_xo-ol1-l_b"><m>0,0,0,2,4,6,8,10,\ldots</m>.</li>

          <li permid="exers_addtops-genfun-e_xo-ol1-l_k"><m>1, 5, 25, 125, \ldots</m>.</li>

          <li permid="exers_addtops-genfun-e_xo-ol1-l_t"><m>1, -3, 9, -27, 81, \ldots</m>.</li>

          <li permid="exers_addtops-genfun-e_xo-ol1-l_c"><m>1, 0, 5, 0, 25, 0, 125, 0, \ldots</m>.</li>

          <li permid="exers_addtops-genfun-e_xo-ol1-l_l">
            <m>0, 1, 0, 0, 2, 0, 0, 3, 0, 0, 4, 0, 0, 5, \ldots</m>.
          </li>
        </ol>
      </p>
    </statement>
    <solution permid="exers_addtops-genfun-e_xo-s1">
      <ol permid="exers_addtops-genfun-e_xo-s1-ol1">
        <li permid="exers_addtops-genfun-e_xo-s1-ol1-l_j"><m>\dfrac{4}{1-x}</m>.</li>

        <li permid="exers_addtops-genfun-e_xo-s1-ol1-l_s"><m>\dfrac{2}{(1-x)^2}</m>.</li>

        <li permid="exers_addtops-genfun-e_xo-s1-ol1-l_b"><m>\dfrac{2x^3}{(1-x}^2</m>.</li>

        <li permid="exers_addtops-genfun-e_xo-s1-ol1-l_k"><m>\dfrac{1}{1-5x}</m>.</li>

        <li permid="exers_addtops-genfun-e_xo-s1-ol1-l_t"><m>\dfrac{1}{1+3x}</m>.</li>

        <li permid="exers_addtops-genfun-e_xo-s1-ol1-l_c"><m>\dfrac{1}{1-5x^2}</m>.</li>

        <li permid="exers_addtops-genfun-e_xo-s1-ol1-l_l"><m>\dfrac{x}{(1-x^3)^2}</m>.</li>
      </ol>
    </solution>
  </exercise>

  <exercise permid="exers_addtops-genfun-e_ag">
    <statement>
      <p permid="exers_addtops-genfun-e_ag-p1">
        Find the sequence generated by the following generating functions:

        <ol permid="exers_addtops-genfun-e_ag-ol1">
          <li permid="exers_addtops-genfun-e_ag-ol1-l_j"><m>\dfrac{4x}{1-x}</m>.</li>

          <li permid="exers_addtops-genfun-e_ag-ol1-l_s"><m>\dfrac{1}{1-4x}</m>.</li>

          <li permid="exers_addtops-genfun-e_ag-ol1-l_b"><m>\dfrac{x}{1+x}</m>.</li>

          <li permid="exers_addtops-genfun-e_ag-ol1-l_k"><m>\dfrac{3x}{(1+x)^2}</m>.</li>

          <li permid="exers_addtops-genfun-e_ag-ol1-l_t">
            <m>\dfrac{1+x+x^2}{(1-x)^2}</m> (Hint: multiplication).
          </li>
        </ol>
      </p>
    </statement>
    <solution permid="exers_addtops-genfun-e_ag-s1">
      <ol permid="exers_addtops-genfun-e_ag-s1-ol1">
        <li permid="exers_addtops-genfun-e_ag-s1-ol1-l_j"><m>0, 4, 4, 4, 4, 4, \ldots</m>.</li>

        <li permid="exers_addtops-genfun-e_ag-s1-ol1-l_s"><m>1, 4, 16, 64, 256, \ldots</m>.</li>

        <li permid="exers_addtops-genfun-e_ag-s1-ol1-l_b"><m>0, 1, -1, 1, -1, 1, -1, \ldots</m>.</li>

        <li permid="exers_addtops-genfun-e_ag-s1-ol1-l_k"><m>0, 3, -6, 9, -12, 15, -18, \ldots</m>.</li>

        <li permid="exers_addtops-genfun-e_ag-s1-ol1-l_t"><m>1, 3, 6, 9, 12, 15, \ldots</m>.</li>
      </ol>
    </solution>
  </exercise>

  <exercise permid="exers_addtops-genfun-e_dp">
    <statement>
      <p permid="exers_addtops-genfun-e_dp-p1">
        Show how you can get the generating function for the triangular numbers in three different ways:
      </p>

      <ol permid="exers_addtops-genfun-e_dp-ol1">
        <li permid="exers_addtops-genfun-e_dp-ol1-l_j">
          <p permid="exers_addtops-genfun-e_dp-ol1-l_j-p1">
            Take two derivatives of the generating function for <m>1,1,1,1,1, \ldots</m>
          </p>
        </li>

        <li permid="exers_addtops-genfun-e_dp-ol1-l_s">
          <p permid="exers_addtops-genfun-e_dp-ol1-l_s-p1">
            Use differencing.
          </p>
        </li>

        <li permid="exers_addtops-genfun-e_dp-ol1-l_b">
          <p permid="exers_addtops-genfun-e_dp-ol1-l_b-p1">
            Multiply two known generating functions.
          </p>
        </li>
      </ol>
    </statement>
    <solution permid="exers_addtops-genfun-e_dp-s1">
      <ol permid="exers_addtops-genfun-e_dp-s1-ol1">
        <li permid="exers_addtops-genfun-e_dp-s1-ol1-l_j">
          <p permid="exers_addtops-genfun-e_dp-s1-ol1-l_j-p1">
            The second derivative of <m>\dfrac{1}{1-x}</m> is
            <m>\dfrac{2}{(1-x)^3}</m> which expands to <m>2 + 6x + 12x^2 + 20x^3 + 30x^4 + \cdots</m>.
            Dividing by 2 gives the generating function for the triangular numbers.
          </p>
        </li>

        <li permid="exers_addtops-genfun-e_dp-s1-ol1-l_s">
          <p permid="exers_addtops-genfun-e_dp-s1-ol1-l_s-p1">
            Compute <m>A - xA</m> and you get
            <m>1 + 2x + 3x^2 + 4x^3 + \cdots</m> which can be written as <m>\dfrac{1}{(1-x)^2}</m>.
            Solving for <m>A</m> gives the correct generating function.
          </p>
        </li>

        <li permid="exers_addtops-genfun-e_dp-s1-ol1-l_b">
          <p permid="exers_addtops-genfun-e_dp-s1-ol1-l_b-p1">
            The triangular numbers are the sum of the first <m>n</m> numbers <m>1,2,3,4, \ldots</m>.
            To get the sequence of partial sums,
            we multiply by <m>\frac{1}{1-x}</m>.
            So this gives the correct generating function again.
          </p>
        </li>
      </ol>
    </solution>
  </exercise>

  <exercise permid="exers_addtops-genfun-e_gy">
    <statement>
      <p permid="exers_addtops-genfun-e_gy-p1">
        Use differencing to find the generating function for <m>4, 5, 7, 10, 14, 19, 25, \ldots</m>.
      </p>
    </statement>
    <solution permid="exers_addtops-genfun-e_gy-s1">
      <p permid="exers_addtops-genfun-e_gy-s1-p1">
        Call the generating function <m>A</m>.
        Compute <m>A - xA = 4 + x + 2x^2 + 3x^3 + 4x^4 + \cdots</m>.
        Thus <m>A - xA = 4 + \dfrac{x}{(1-x)^2}</m>.
        Solving for <m>A</m> gives <m>\d\frac{4}{1-x} + \frac{x}{(1-x)^3}</m>.
      </p>
    </solution>
  </exercise>

  <exercise permid="exers_addtops-genfun-e_jq">
    <statement>
      <p permid="exers_addtops-genfun-e_jq-p1">
        Find a generating function for the sequence with recurrence relation
        <m>a_n = 3a_{n-1} - a_{n-2}</m> with initial terms <m>a_0 = 1</m> and <m>a_1 = 5</m>.
      </p>
    </statement>
    <solution permid="exers_addtops-genfun-e_jq-s1">
      <p permid="exers_addtops-genfun-e_jq-s1-p1">
        <m>\dfrac{1+2x}{1-3x + x^2}</m>.
      </p>
    </solution>
  </exercise>

  <exercise permid="exers_addtops-genfun-e_mz">
    <statement>
      <p permid="exers_addtops-genfun-e_mz-p1">
        Use the recurrence relation for the Fibonacci numbers to find the generating function for the Fibonacci sequence.
      </p>
    </statement>
    <solution permid="exers_addtops-genfun-e_mz-s1">
      <p permid="exers_addtops-genfun-e_mz-s1-p1">
        Compute <m>A - xA - x^2A</m> and the solve for <m>A</m>.
        The generating function will be <m>\dfrac{x}{1-x-x^2}</m>.
      </p>
    </solution>
  </exercise>

  <exercise permid="exers_addtops-genfun-e_pi">
    <statement>
      <p permid="exers_addtops-genfun-e_pi-p1">
        Use multiplication to find the generating function for the sequence of partial sums of Fibonacci numbers,
        <m>S_0, S_1, S_2, \ldots</m> where
        <m>S_0 = F_0</m>, <m>S_1 = F_0 + F_1</m>,
        <m>S_2 = F_0 + F_1 + F_2</m>,
        <m>S_3 = F_0 + F_1 + F_2 + F_3</m> and so on.
      </p>
    </statement>
    <solution permid="exers_addtops-genfun-e_pi-s1">
      <p permid="exers_addtops-genfun-e_pi-s1-p1">
        <m>\dfrac{x}{(1-x)(1-x-x^2)}</m>.
      </p>
    </solution>
  </exercise>

  <exercise permid="exers_addtops-genfun-e_sa">
    <statement>
      <p permid="exers_addtops-genfun-e_sa-p1">
        Find the generating function for the sequence with closed formula <m>a_n = 2(5^n) + 7(-3)^n</m>.
      </p>
    </statement>
    <solution permid="exers_addtops-genfun-e_sa-s1">
      <p permid="exers_addtops-genfun-e_sa-s1-p1">
        <m>\dfrac{2}{1-5x} + \dfrac{7}{1+3x}</m>.
      </p>
    </solution>
  </exercise>

  <exercise permid="exers_addtops-genfun-e_vj">
    <statement>
      <p permid="exers_addtops-genfun-e_vj-p1">
        Find a closed formula for the <m>n</m>th term of the sequence with generating function <m>\dfrac{3x}{1-4x} + \dfrac{1}{1-x}</m>.
      </p>
    </statement>
    <solution permid="exers_addtops-genfun-e_vj-s1">
      <p permid="exers_addtops-genfun-e_vj-s1-p1">
        <m>a_n = 3\cdot 4^{n-1} + 1</m>.
      </p>
    </solution>
  </exercise>

  <exercise permid="exers_addtops-genfun-e_ys">
    <statement>
      <p permid="exers_addtops-genfun-e_ys-p1">
        Find <m>a_7</m> for the sequence with generating function <m>\dfrac{2}{(1-x)^2}\cdot\dfrac{x}{1-x-x^2}</m>.
      </p>
    </statement>
    <solution permid="exers_addtops-genfun-e_ys-s1">
      <p permid="exers_addtops-genfun-e_ys-s1-p1">
        Hint: you should <q>multiply</q> the two sequences.
        Answer: 158.
      </p>
    </solution>
  </exercise>

  <exercise permid="exers_addtops-genfun-e_bk">
    <statement>
      <p permid="exers_addtops-genfun-e_bk-p1">
        Explain how we know that <m>\dfrac{1}{(1-x)^2}</m> is the generating function for <m>1, 2, 3, 4, \ldots</m>.
      </p>
    </statement>
    <solution permid="exers_addtops-genfun-e_bk-s1">
      <p permid="exers_addtops-genfun-e_bk-s1-p1">
        Starting with <m>\frac{1}{1-x} = 1 + x + x^2 + x^3 +\cdots</m>,
        we can take derivatives of both sides,
        given <m>\frac{1}{(1-x)^2} = 1 + 2x + 3x^2 + \cdots</m>.
        By the definition of generating functions,
        this says that <m>\frac{1}{(1-x)^2}</m> generates the
        <em>sequence</em> 1, 2, 3<ellipsis/>.
        You can also find this using differencing or by multiplying.
      </p>
    </solution>
  </exercise>

  <exercise permid="exers_addtops-genfun-e_et">
    <statement>
      <p permid="exers_addtops-genfun-e_et-p1">
        Starting with the generating function for <m>1,2,3,4, \ldots</m>,
        find a generating function for each of the following sequences.
      </p>

      <ol permid="exers_addtops-genfun-e_et-ol1">
        <li permid="exers_addtops-genfun-e_et-ol1-l_j"><m>1, 0, 2, 0, 3, 0, 4,\ldots</m>.</li>

        <li permid="exers_addtops-genfun-e_et-ol1-l_s"><m>1, -2, 3, -4, 5, -6, \ldots</m>.</li>

        <li permid="exers_addtops-genfun-e_et-ol1-l_b"><m>0, 3, 6, 9, 12, 15, 18, \ldots</m>.</li>

        <li permid="exers_addtops-genfun-e_et-ol1-l_k">
          <m>0, 3, 9, 18, 30, 45, 63,\ldots</m>.
          (Hint:
          relate this sequence to the previous one.)
        </li>
      </ol>
    </statement>
    <solution permid="exers_addtops-genfun-e_et-s1">
      <ol permid="exers_addtops-genfun-e_et-s1-ol1">
        <li permid="exers_addtops-genfun-e_et-s1-ol1-l_j"><m>\frac{1}{(1-x^2)^2}</m>.</li>

        <li permid="exers_addtops-genfun-e_et-s1-ol1-l_s"><m>\frac{1}{(1+x)^2}</m>.</li>

        <li permid="exers_addtops-genfun-e_et-s1-ol1-l_b"><m>\frac{3x}{(1-x)^2}</m>.</li>

        <li permid="exers_addtops-genfun-e_et-s1-ol1-l_k">
          <m>\frac{3x}{(1-x)^3}</m>.
          (partial sums).
        </li>
      </ol>
    </solution>
  </exercise>

  <exercise permid="exers_addtops-genfun-e_hc">
    <statement>
      <p permid="exers_addtops-genfun-e_hc-p1">
        You may assume that <m>1, 1, 2, 3, 5, 8,\ldots</m> has generating function <m>\dfrac{1}{1-x-x^2}</m>
        (because it does).
        Use this fact to find the sequence generated by each of the following generating functions.
      </p>

      <ol permid="exers_addtops-genfun-e_hc-ol1">
        <li permid="exers_addtops-genfun-e_hc-ol1-l_j"><m>\frac{x^2}{1-x-x^2}</m>.</li>

        <li permid="exers_addtops-genfun-e_hc-ol1-l_s"><m>\frac{1}{1-x^2-x^4}</m>.</li>

        <li permid="exers_addtops-genfun-e_hc-ol1-l_b"><m>\frac{1}{1-3x-9x^2}</m>.</li>

        <li permid="exers_addtops-genfun-e_hc-ol1-l_k"><m>\frac{1}{(1-x-x^2)(1-x)}</m>.</li>
      </ol>
    </statement>
    <solution permid="exers_addtops-genfun-e_hc-s1">
      <ol permid="exers_addtops-genfun-e_hc-s1-ol1">
        <li permid="exers_addtops-genfun-e_hc-s1-ol1-l_j"><m>0,0,1,1,2,3,5,8, \ldots</m>.</li>

        <li permid="exers_addtops-genfun-e_hc-s1-ol1-l_s"><m>1, 0, 1, 0, 2, 0, 3, 0, 5, 0, 8, 0, \ldots</m>.</li>

        <li permid="exers_addtops-genfun-e_hc-s1-ol1-l_b"><m>1, 3, 18, 81, 405, \ldots</m>.</li>

        <li permid="exers_addtops-genfun-e_hc-s1-ol1-l_k"><m>1, 2, 4, 7, 12, 20, \ldots</m>.</li>
      </ol>
    </solution>
  </exercise>

  <exercise permid="exers_addtops-genfun-e_ku">
    <statement>
      <p permid="exers_addtops-genfun-e_ku-p1">
        Find the generating function for the sequence <m>1, -2, 4, -8, 16, \ldots</m>.
      </p>
    </statement>
    <solution permid="exers_addtops-genfun-e_ku-s1">
      <p permid="exers_addtops-genfun-e_ku-s1-p1">
        <m>\frac{1}{1+2x}</m>.
      </p>
    </solution>
  </exercise>

  <exercise permid="exers_addtops-genfun-e_nd">
    <statement>
      <p permid="exers_addtops-genfun-e_nd-p1">
        Find the generating function for the sequence <m>1, 1, 1, 2, 3, 4, 5, 6, \ldots</m>.
      </p>
    </statement>
    <solution permid="exers_addtops-genfun-e_nd-s1">
      <p permid="exers_addtops-genfun-e_nd-s1-p1">
        <m>\frac{x^3}{(1-x)^2} + \frac{1}{1-x}</m>.
      </p>
    </solution>
  </exercise>

  <exercise permid="exers_addtops-genfun-e_qm">
    <statement>
      <p permid="exers_addtops-genfun-e_qm-p1">
        Suppose <m>A</m> is the generating function for the sequence <m>3, 5, 9, 15, 23, 33, \ldots</m>.
      </p>

      <ol permid="exers_addtops-genfun-e_qm-ol1">
        <li permid="exers_addtops-genfun-e_qm-ol1-l_j">
          <p permid="exers_addtops-genfun-e_qm-ol1-l_j-p1">
            Find a generating function
            (in terms of <m>A</m>)
            for the sequence of differences between terms.
          </p>
        </li>

        <li permid="exers_addtops-genfun-e_qm-ol1-l_s">
          <p permid="exers_addtops-genfun-e_qm-ol1-l_s-p1">
            Write the sequence of differences between terms and find a generating function for it
            (without referencing <m>A</m>).
          </p>
        </li>

        <li permid="exers_addtops-genfun-e_qm-ol1-l_b">
          <p permid="exers_addtops-genfun-e_qm-ol1-l_b-p1">
            Use your answers to parts (a) and (b) to find the generating function for the original sequence.
          </p>
        </li>
      </ol>
    </statement>
    <solution permid="exers_addtops-genfun-e_qm-s1">
      <ol permid="exers_addtops-genfun-e_qm-s1-ol1">
        <li permid="exers_addtops-genfun-e_qm-s1-ol1-l_j">
          <m>(1-x)A = 3 + 2x + 4x^2 + 6x^3 + \cdots</m> which is almost right.
          We can fix it like this:
		 <m>2 + 4x + 6x^2 + \cdots = \frac{(1-x)A - 3}{x}</m>.
        </li>

        <li permid="exers_addtops-genfun-e_qm-s1-ol1-l_s">
          <p permid="exers_addtops-genfun-e_qm-s1-ol1-l_s-p1">
            We know <m>2 + 4x + 6x^3 + \cdots = \frac{2}{(1-x)^2}</m>.
          </p>
        </li>

        <li permid="exers_addtops-genfun-e_qm-s1-ol1-l_b">
          <m>A = \frac{2x}{(1-x)^3} + \frac{3}{1-x} = \frac{3 -4x + 3x^2}{(1-x)^3}</m>.
        </li>
      </ol>
    </solution>
  </exercise>

</exercises>
